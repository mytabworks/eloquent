parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"BfoG":[function(require,module,exports) {
parcelRequire=function(e,t,r,n){var o,i="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function a(r,n){if(!t[r]){if(!e[r]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(r,!0);if(i)return i(r,!0);if(u&&"string"==typeof r)return u(r);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}f.resolve=function(t){return e[r][1][t]||t},f.cache={};var c=t[r]=new a.Module(r);e[r][0].call(c.exports,f,c,c.exports,this)}return t[r].exports;function f(e){return a(f.resolve(e))}}a.isParcelRequire=!0,a.Module=function(e){this.id=e,this.bundle=a,this.exports={}},a.modules=e,a.cache=t,a.parent=i,a.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]};for(var l=0;l<r.length;l++)try{a(r[l])}catch(e){o||(o=e)}if(r.length){var c=a(r[r.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd&&define(function(){return c})}if(parcelRequire=a,o)throw o;return a}({QCba:[function(e,t,r){"use strict";var n=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)n[o]=i[u];return n};Object.defineProperty(r,"__esModule",{value:!0});var i=function(e,t){void 0===t&&(t=!1);var r=!0,u=!1,a=!1;e.prototype.__iterator&&(u=!0,e.prototype[Symbol.iterator]=function(){var e=this.__iterator(),t=-1,r=e.length;return Array.isArray(e)?{next:function(){return{done:r===++t,value:e[t]}}}:function(){var t,r,o,i;return n(this,function(n){switch(n.label){case 0:for(r in t=[],e)t.push(r);o=0,n.label=1;case 1:return o<t.length?[4,{key:i=t[o],value:e[i]}]:[3,4];case 2:n.sent(),n.label=3;case 3:return o++,[3,1];case 4:return[2]}})}()});var l=Object.create(null);return l.construct=function(t,n){var a=new(e.bind.apply(e,o([void 0],n))),l=Object.create(null);return e.prototype.__get&&(u=!0,l.get=function(e,t,n){r=!1;var o=t in e;return r=!0,"__illusion__"===t?e:"constructor"===t?i(e[t]):o?e[t]:e.__get.call(n,t)}),e.prototype.__getAll&&(u=!0,l.get=function(e,t){return e.__getAll.call(e,t)}),e.prototype.__set&&(u=!0,l.set=function(e,t,r){return t in e?e[t]=r:e.__set.call(e,t,r),!0}),e.prototype.__isset&&(u=!0,l.has=function(e,t){return r?e.__isset.call(e,t):t in e}),e.prototype.__unset&&(u=!0,l.deleteProperty=function(e,t){return e.__unset.call(e,t),!0}),u?new Proxy(a,l):a},"__getStatic"in e&&(a=!0,l.get=function(e,t){return t in e?e[t]:e.__getStatic(t)}),"__setStatic"in e&&(a=!0,l.set=function(e,t,r){return t in e?e[t]=r:e.__setStatic(t,r),!0}),"__callStatic"in e&&(a=!0,l.get=function(e,t,r){return"__illusion__"===t?e:e[t]||e.__callStatic.call(r,t)}),a||u||t?new Proxy(e,l):e};r.default=i},{}]},{},["QCba"]);
},{}],"R6uy":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("illusionjs")),r=function(e){return t.default(e)};exports.default=r;
},{"illusionjs":"BfoG"}],"cXx1":[function(require,module,exports) {
"use strict";var t=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<i;e++)for(var n=arguments[e],s=0,u=n.length;s<u;s++,o++)r[o]=n[s];return r},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=e(require("illusionjs")),r=function(){function e(t,e){void 0===e&&(e=0),this._items=t,this._totalCount=e,this._multiple=Array.isArray(t),this.hasItem=this._multiple?t.length>0:null!==t}return e.prototype.splice=function(t,e){if(this._multiple)return this.getItems().splice(t,e)},e.prototype.itemCount=function(){if(this._multiple)return this.getItems().length},e.prototype.totalCount=function(){return this._totalCount},e.prototype.setTotalCount=function(t){this._totalCount=t},e.prototype.getItems=function(){return this._items},e.prototype.first=function(){return this._multiple&&(this._items=this._items[0],this._multiple=!1),this},e.prototype.valueOf=function(){return this.toString()},e.prototype.toJSON=function(){var t=this.getItems();return this.hasItem&&(t=this._multiple?t.map(function(t){return t.toJSON()}):t.toJSON()),t},e.prototype.toString=function(){return JSON.stringify(this.toJSON(),null,2)},e.prototype.reduce=function(e,i){return t(this).reduce(e,i)},e.prototype.map=function(e){return t(this).map(e)},e.prototype.filter=function(e){return t(this).filter(e)},e.prototype.forEach=function(e){return t(this).forEach(e)},e.prototype.__iterator=function(){return this.hasItem?this._multiple?this.getItems():this.getItems().__iterator():[]},e.prototype.__get=function(t){var e=this.getItems();if(this.hasItem)return!this._multiple&&"function"==typeof e[t]?function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return e[t].apply(e,i)}:e[t]},e.prototype.__set=function(t,e){!this._multiple&&this.hasItem&&(this.getItems()[t]=e)},e.prototype.__isset=function(t){if(!this._multiple&&this.hasItem)return t in this.getItems()},e.prototype.__unset=function(t){!this._multiple&&this.hasItem&&delete this.getItems()[t]},e}();exports.default=i.default(r);
},{"illusionjs":"BfoG"}],"BPgb":[function(require,module,exports) {
module.exports=require('typeorm');
},{}],"UJnB":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},e=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,s){function o(t){try{a(n.next(t))}catch(e){s(e)}}function u(t){try{a(n.throw(t))}catch(e){s(e)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(o,u)}a((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(u){s=[6,u],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("typeorm"),i=function(){function i(t){this._select=[],this._where=[],this._parameters={},this._whereStart=[],this._orderBy=[],this._modelClass=t}return i.prototype.modelizeData=function(e){var r=this;return Array.isArray(e)?e.map(function(t){return r.modelizeData(t)}):new this._modelClass({exists:!0,attributes:t({},e)})},i.prototype.now=function(){return Date.now()},i.prototype.from=function(t){var e=t.split(" as "),r=e[0],n=e[1];return this._table=r,this._alias=n,this},i.prototype.as=function(t){return this._alias=t,this},i.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._select=t,this},i.prototype.whereFactory=function(t,e,r,n){var i="S"+(this._where.length+1);return this._where.push([t+" "+e+" "+(["IN","NOT IN"].includes(e)?"(:..."+i+")":["BETWEEN","NOT BETWEEN"].includes(e)?":"+i+"1 AND :"+i+"2":":"+i),n]),["BETWEEN","NOT BETWEEN"].includes(e)?(this._parameters[i+"1"]=r[0],this._parameters[i+"2"]=r[1]):this._parameters[i]=r||e,this},i.prototype.where=function(t,e,r){return r?this.whereFactory(t,e,r,"AND"):this.whereFactory(t,"=",e,"AND")},i.prototype.orWhere=function(t,e,r){return r?this.whereFactory(t,e,r,"OR"):this.whereFactory(t,"=",e,"OR")},i.prototype.whereIn=function(t,e){return this.where(t,"IN",e)},i.prototype.whereNotIn=function(t,e){return this.where(t,"NOT IN",e)},i.prototype.orWhereIn=function(t,e){return this.orWhere(t,"IN",e)},i.prototype.orWhereNotIn=function(t,e){return this.orWhere(t,"NOT IN",e)},i.prototype.whereBetween=function(t,e){return this.where(t,"BETWEEN",e)},i.prototype.whereNotBetween=function(t,e){return this.where(t,"NOT BETWEEN",e)},i.prototype.orWhereBetween=function(t,e){return this.orWhere(t,"BETWEEN",e)},i.prototype.orWhereNotBetween=function(t,e){return this.orWhere(t,"NOT BETWEEN",e)},i.prototype.orderBy=function(t,e){return this._orderBy.push([t,e]),this},i.prototype.limit=function(t){return this._limit=t,this},i.prototype.take=function(t){return this._take=t,this},i.prototype.offset=function(t){return this._offset=t,this},i.prototype.skip=function(t){return this._skip=t,this},i.prototype.first=function(){return e(this,void 0,Promise,function(){var t,e;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.querying("select").getRawOne()];case 1:return[2,(t=r.sent())?this.modelizeData(t):null];case 2:throw e=r.sent(),new Error(e);case 3:return[2]}})})},i.prototype.get=function(){return e(this,void 0,Promise,function(){var t,e;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.querying("select").getRawMany()];case 1:return t=r.sent(),[2,this.modelizeData(t)];case 2:throw e=r.sent(),new Error(e);case 3:return[2]}})})},i.prototype.count=function(t){return void 0===t&&(t="*"),e(this,void 0,Promise,function(){var t;return r(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.querying("select").getCount()];case 1:return[2,e.sent()];case 2:throw t=e.sent(),new Error(t);case 3:return[2]}})})},i.prototype.paginate=function(t,n){return void 0===n&&(n=10),e(this,void 0,Promise,function(){var e;return r(this,function(r){switch(r.label){case 0:return[4,this.skip(t*n-n).take(n).get()];case 1:return e=r.sent(),this._take=this._skip=void 0,[4,this.count()];case 2:return[2,{count:r.sent(),models:e}]}})})},i.prototype.insert=function(t){return e(this,void 0,Promise,function(){var e;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.querying("insert",t).execute()];case 1:return[2,r.sent().identifiers];case 2:throw e=r.sent(),new Error(e);case 3:return[2]}})})},i.prototype.update=function(t){return e(this,void 0,Promise,function(){var e;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.querying("update",t).execute()];case 1:return[2,r.sent().affected];case 2:throw e=r.sent(),new Error(e);case 3:return[2]}})})},i.prototype.delete=function(){return e(this,void 0,Promise,function(){var t;return r(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.querying("delete").execute()];case 1:return[2,e.sent().affected];case 2:throw t=e.sent(),new Error(t);case 3:return[2]}})})},i.prototype.querying=function(t,e){var r=n.getConnection().createQueryBuilder(),i=this._modelClass.entity,s=this._modelClass.table;switch(t){case"insert":r=r.insert().into(i).values(e);break;case"update":r=r.update(i).set(e);break;case"delete":r=r.delete().from(i);break;case"select":this._select.length&&(r=this._select.reduce(function(t,e,r){var n=0===r,i=e.trim().split(" as "),s=i[0],o=i[1];return n?t.select(s,o):t.addSelect(s,o)},r)),r=r.from(i,this._alias||s)}return this._where.length&&(r=this._where.reduce(function(t,e,r){var n=e[0],i=e[1];return 0===r?t.where(n):"AND"===i?t.andWhere(n):t.orWhere(n)},r)),"select"===t&&(this._limit&&(r=r.limit(this._limit)),this._offset&&(r=r.offset(this._limit)),this._take&&(r=r.take(this._take)),this._skip&&(r=r.skip(this._skip)),this._orderBy.length&&(r=this._orderBy.reduce(function(t,e){return t.orderBy.apply(t,e)},r))),Object.keys(this._parameters).length&&r.setParameters(this._parameters),r},i}();exports.default=i;
},{"typeorm":"BPgb"}],"OO4R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,e){this._relativeBuilder=t,this._currentModel=e,this._relativeModel=t.getModel()}return t.noConstraints=function(t){var e=this.constraints;this.constraints=!1;var r=t();return this.constraints=e,r},t.prototype.getRelativeBuilder=function(){return this._relativeBuilder},t.prototype.getRelativeModel=function(){return this._relativeModel},t.prototype.getCurrentModel=function(){return this._currentModel},t.prototype.getCurrentModelsId=function(t){return t.map(function(t){return t.getPrimaryKeyId()})},t.prototype.__get=function(t){var e=this,r=this.getRelativeBuilder();if(r[t])return function(){for(var n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var u=(n=r)[t].apply(n,i);return u===r?e:u}},t.constraints=!0,t}();exports.default=t;
},{}],"G2GE":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(s,i){function o(t){try{a(r.next(t))}catch(e){i(e)}}function u(t){try{a(r.throw(t))}catch(e){i(e)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,u)}a((r=r.apply(t,e||[])).next())})},e=this&&this.__generator||function(t,e){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(u){i=[6,u],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var r=n(require("illusionjs")),s=n(require("./Relationships")),i=n(require("./Collection")),o=function(){function n(t,e){this._persistentLoad={},this._factoryMethodThatCanReturn=["insert","delete","update","count","min","max","avg","sum","now"],this._query=t,this._model=e,this._modelName=e.constructor.name}return n.prototype.filterPersistentLoads=function(t,e){void 0===e&&(e=0);var n=this._persistentLoad;return Object.keys(n).filter(t).reduce(function(t,r){return void 0===t&&(t={}),t[r.substr(e)]=n[r],t},void 0)},n.prototype.unnestedPersistentLoads=function(){return this.filterPersistentLoads(function(t){return!t.includes(".")})},n.prototype.persistentLoadRelations=function(n){return t(this,void 0,Promise,function(){var t,r=this;return e(this,function(e){switch(e.label){case 0:return(t=this.unnestedPersistentLoads())?[4,Promise.all(Object.keys(t).map(function(e){return r.loadRelationship(n,e,t[e])}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,n]}})})},n.prototype.loadRelationship=function(n,r,s){return t(this,void 0,void 0,function(){var t,i;return e(this,function(e){switch(e.label){case 0:return(t=this.getRelative(r)).addPersistentConstraints(n),s.call(t,t),[4,t.get()];case 1:return i=e.sent(),[2,t.match(n,i,r)]}})})},n.prototype.persistentDeleteRelations=function(n){return t(this,void 0,Promise,function(){var t,r,s=this;return e(this,function(e){switch(e.label){case 0:return(t=this.unnestedPersistentLoads())?(r=Object.keys(t),[4,Promise.all(r.map(function(e){return s.deleteRelationship(n,e,t[e])}))]):[3,2];case 1:return[2,e.sent().reduce(function(t,e,n){return t[r[n]]=e,t},{})];case 2:return[2]}})})},n.prototype.deleteRelationship=function(t,e,n){var r=this.getRelative(e);return r.addPersistentConstraints(t),n.call(r,r),r.delete()},n.prototype.getRelative=function(t){var e=this,n=s.default.noConstraints(function(){return e.getModel()[t]()}),r=this.thirdPartyRelations(t);return r&&n.with(r),n},n.prototype.thirdPartyRelations=function(t){var e=(t+".").length;return this.filterPersistentLoads(function(e){return e.includes(t)&&e.includes(".")},e)},n.prototype.normalizePersistentLoad=function(t){return Object.keys(t).reduce(function(e,n){var r=t[n];return n.includes(".")?n.split(".").forEach(function(t,n,s){var i=n===s.length-1,o=s.slice(0,n+1).join(".");o in e||(e[o]=i?r:function(){})}):n in e||(e[n]=r),e},{})},n.prototype.setPersistentLoad=function(t){var e=this.normalizePersistentLoad(t);this._persistentLoad=e},n.prototype.with=function(t){var e;return"string"==typeof t?((e={})[t]=function(){},t=e):Array.isArray(t)&&(t=t.reduce(function(t,e){return t[e]=function(){},t},{})),this.setPersistentLoad(t),this},n.prototype.find=function(t,e,n){var r;return(r=this.getQuery()).select.apply(r,e).where(this.getModel().getPrimaryKey(),t),n&&this.with(n),this.first()},n.prototype.first=function(){return t(this,void 0,Promise,function(){var t,n;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this.getQuery().first()];case 1:return(t=e.sent())?[4,this.persistentLoadRelations([t])]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2,new i.default(t)];case 4:throw n=e.sent(),new Error(n.message);case 5:return[2]}})})},n.prototype.get=function(){return t(this,void 0,Promise,function(){var t,n;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this.getQuery().get()];case 1:return(t=e.sent()).length?[4,this.persistentLoadRelations(t)]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2,new i.default(t)];case 4:throw n=e.sent(),new Error(n.message);case 5:return[2]}})})},n.prototype.paginate=function(n,r){return t(this,void 0,Promise,function(){var t,s,o,u;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this.getQuery().paginate(n,r)];case 1:return t=e.sent(),s=t.models,o=t.count,s.length?[4,this.persistentLoadRelations(s)]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2,new i.default(s,o)];case 4:throw u=e.sent(),new Error(u.message);case 5:return[2]}})})},n.prototype.delete=function(){return t(this,void 0,Promise,function(){var t,n,r;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),[4,this.getQuery().get()];case 1:return t=e.sent(),n=void 0,t.length&&Object.keys(this._persistentLoad).length?[4,this.persistentDeleteRelations(t)]:[3,3];case 2:n=e.sent(),e.label=3;case 3:return[4,this.getQuery().delete()];case 4:return[2,{itemsDeleted:e.sent(),relativeDeleted:n}];case 5:throw r=e.sent(),new Error(r.message);case 6:return[2]}})})},n.prototype.isReturnableFactoryMethod=function(t){return this._factoryMethodThatCanReturn.includes(t)},n.prototype.getQuery=function(){return this._query},n.prototype.getModel=function(){return this._model},n.prototype.__get=function(t){var e=this,n=this._modelName;if("symbol"==typeof t)return function(){return"do not use console.log("+n+") use instead console.log("+n+".toJson())"};var r=this.getQuery();if(!(t in r))throw new Error(n+"."+t+" does not exists");return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var i=r[t].apply(r,n);return e.isReturnableFactoryMethod(t)?i:e}},n}();exports.default=r.default(o);
},{"illusionjs":"BfoG","./Relationships":"OO4R","./Collection":"cXx1"}],"Y4dg":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require(".")),n=function(e){function n(t,r,n,o){var i=e.call(this,t,r)||this;return i._currentKey=o,i._foreignKey=n,i.addDefaultConstraints(),i}return t(n,e),n.prototype.addDefaultConstraints=function(){r.default.constraints&&this.getRelativeBuilder().where(this.getForeignkey(),this.getCurrentModel().getPrimaryKeyId())},n.prototype.getForeignkey=function(){return this._foreignKey},n.prototype.getCurrentKey=function(){return this._currentKey},n.prototype.addPersistentConstraints=function(t){this.getRelativeBuilder().whereIn(this.getForeignkey(),this.getCurrentModelsId(t))},n.prototype.match=function(t,e,r){throw Error("match is not in hasOne or hasMany")},n.prototype.matchOneOrMany=function(t,e,r,n){var o=this,i=this.setForeignKeyAsResultIndex(e);return t.forEach(function(t){var e=t.getPrimaryKeyId();e in i&&t.setRelative(r,o.getRelationValue(i[e],n))}),!0},n.prototype.setForeignKeyAsResultIndex=function(t){var e=this.getForeignkey();return t.reduce(function(t,r){var n=r[e];return n in t?t[n].push(r):t[n]=[r],t},{})},n.prototype.getRelationValue=function(t,e){return"one"===e?t[0]:t},n}(r.default);exports.default=n;
},{".":"OO4R"}],"cNxe":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},n=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function u(t){try{s(r.next(t))}catch(e){i(e)}}function a(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}s((r=r.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=o(require("illusionjs")),u=o(require("./HasOneOrMany")),a=function(o){function i(){return null!==o&&o.apply(this,arguments)||this}return t(i,o),i.prototype.match=function(t,e,n){return this.matchOneOrMany(t,e,n,"one")},i.prototype.get=function(){return this.getRelativeBuilder().first()},i.prototype.findOrNew=function(t){return n(this,void 0,Promise,function(){var n,o,i,u,a,s;return r(this,function(r){switch(r.label){case 0:return n=this.getCurrentModel(),o=this.getRelativeModel(),i=this.getForeignkey(),u=n.getPrimaryKeyId(),[4,this.getRelativeBuilder().where(i,u).first()];case 1:return a=r.sent(),[2,Object.assign(a.hasItem?a.getItems():o,e(e({},t),(s={},s[i]=u,s)))]}})})},i}(u.default);exports.default=i.default(a);
},{"illusionjs":"BfoG","./HasOneOrMany":"Y4dg"}],"bkXW":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var n=r(require("illusionjs")),o=r(require("./HasOneOrMany")),i=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return t(n,r),n.prototype.match=function(t,e,r){return this.matchOneOrMany(t,e,r,"many")},n.prototype.create=function(t){var r,n=this.getCurrentModel(),o=new(this.getRelativeModel().constructor),i=this.getForeignkey();return Object.assign(o,e(((r={})[i]=n.getPrimaryKeyId(),r),t))},n}(o.default);exports.default=n.default(i);
},{"illusionjs":"BfoG","./HasOneOrMany":"Y4dg"}],"IAWZ":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("illusionjs")),n=e(require(".")),o=function(e){function r(t,r,n,o){var i=e.call(this,t,r)||this;return i._ownerKey=o,i._foreignKey=n,i.addDefaultConstraints(),i}return t(r,e),r.prototype.addDefaultConstraints=function(){if(n.default.constraints){var t=this.getCurrentModel();this.getRelativeBuilder().where(this.getOwnerKey(),t[this.getForeignkey()])}},r.prototype.getForeignkey=function(){return this._foreignKey},r.prototype.getOwnerKey=function(){return this._ownerKey},r.prototype.addPersistentConstraints=function(t){this.getRelativeBuilder().whereIn(this.getOwnerKey(),this.getCurrentModelsId(t))},r.prototype.getCurrentModelsId=function(t){var e=this;return t.map(function(t){return t[e.getForeignkey()]})},r.prototype.match=function(t,e,r){var n=this,o=this.setPrimaryKeyAsResultIndex(e);return t.forEach(function(t){var e=t[n.getForeignkey()];e in o&&t.setRelative(r,n.getRelationValue(o[e]))}),!0},r.prototype.setPrimaryKeyAsResultIndex=function(t){var e=this.getOwnerKey();return t.reduce(function(t,r){var n=r[e];return n in t?t[n].push(r):t[n]=[r],t},{})},r.prototype.getRelationValue=function(t){return t[0]},r}(n.default);exports.default=r.default(o);
},{"illusionjs":"BfoG",".":"OO4R"}],"NviM":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},e=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,s){function o(t){try{a(i.next(t))}catch(e){s(e)}}function u(t){try{a(i.throw(t))}catch(e){s(e)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(o,u)}a((i=i.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var r,i,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(u){s=[6,u],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var n=i(require("./Collection")),s=i(require("./Query")),o=i(require("./Builder")),u=i(require("./Relationships/HasOne")),a=i(require("./Relationships/HasMany")),c=i(require("./Relationships/BelongsTo")),h=function(){function i(e){void 0===e&&(e={}),this.relatives={},this.originals={},this.attributes={},this.primaryKey="id",this.guarded=[],this.fillable=[],this.updatable=[],this.updatedAtColumn="updated_at",this.createdAtColumn="created_at",this.timestamp=!0,this.exists=!1;var r=e.exists,i=e.attributes;r&&i&&(this.originals=t({},i),this.attributes=t({},i),this.exists=r)}return i.prototype.isFillable=function(t){return this.exists&&this.updatable.length?this.updatable.includes(t):!!this.fillable.includes(t)||!this.isGuarded(t)&&0===this.fillable.length},i.prototype.isGuarded=function(t){return this.guarded.includes(t)||this.guarded.includes("*")},i.prototype.syncAttrAndOrig=function(){this.originals=t({},this.attributes)},i.prototype.getAttributes=function(){return this.attributes},i.prototype.getAttribute=function(t){if("symbol"==typeof t)return"do not console.log(sampleinstance) use sampleinstance.toJSON()";if(t in this.attributes)return this.attributes[t];var e=0===t.indexOf("$")?t.substr(1):t;return e in this.relatives?this.relatives[e]:void 0},i.prototype.setAttribute=function(t,e){this.isFillable(t)&&(this.attributes[t]=e)},i.prototype.setAttributeRaw=function(t,e){this.attributes[t]=e},i.prototype.getAttributeChanges=function(){var t=this.originals,e=this.attributes;return Object.keys(e).filter(function(r){return"id"!==r&&t[r]!==e[r]}).reduce(function(t,r){return void 0===t&&(t={}),t[r]=e[r],t},void 0)},i.prototype.setTimestamps=function(t){this.setAttributeRaw(this.updatedAtColumn,t),this.exists||this.setAttributeRaw(this.createdAtColumn,t)},i.prototype.setPrimaryKeyForSave=function(t){return t.where(this.primaryKey,this.getPrimaryKeyId())},i.prototype.getPrimaryKeyId=function(){var t=this.originals[this.primaryKey];return t||this.getAttribute(this.primaryKey)},i.prototype.getPrimaryKey=function(){return this.primaryKey},i.prototype.queryInsert=function(t){return e(this,void 0,Promise,function(){var e,i;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.timestamp&&this.setTimestamps(t.now()),[4,t.insert(this.getAttributes())];case 1:return e=r.sent()[0].id,this.setAttributeRaw(this.primaryKey,e),this.exists=!0,[2,e];case 2:throw i=r.sent(),new Error(i.message);case 3:return[2]}})})},i.prototype.queryUpdate=function(t){return e(this,void 0,Promise,function(){var e,i;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(e=this.getAttributeChanges())?(this.timestamp&&(this.setTimestamps(t.now()),e=this.getAttributeChanges()),[4,this.setPrimaryKeyForSave(t).update(e)]):[2,!1];case 1:return r.sent(),[2,!0];case 2:throw i=r.sent(),new Error(i.message);case 3:return[2]}})})},i.prototype.queryDelete=function(t){return e(this,void 0,Promise,function(){var e;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.setPrimaryKeyForSave(t).delete()];case 1:return r.sent(),[3,3];case 2:throw e=r.sent(),new Error(e.message);case 3:return[2,!0]}})})},i.prototype.createBuilder=function(){return new o.default(this.createQuery(),this)},i.prototype.createQuery=function(){return new s.default(this.constructor)},i.prototype.setRelative=function(t,e){this.relatives[t]=new n.default(e)},i.prototype.getForeignKey=function(){return this.constructor.table+"_"+this.primaryKey},i.prototype.belongsTo=function(t,e,r){var i=new t,n=e||this.constructor.table+"."+i.getForeignKey(),s=r||i.primaryKey;return new c.default(i.createBuilder(),this,n,s)},i.prototype.hasOneOrMany=function(t,e,r,i){var n=new e,s=r||n.table()+"."+this.getForeignKey(),o=i||this.primaryKey;return new t(n.createBuilder(),this,s,o)},i.prototype.hasOne=function(t,e,r){return this.hasOneOrMany(u.default,t,e,r)},i.prototype.hasMany=function(t,e,r){return this.hasOneOrMany(a.default,t,e,r)},i.prototype.save=function(t){return e(this,void 0,Promise,function(){var e,i,n;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),t&&Object.assign(this,t),e=this.createBuilder(),i=void 0,this.exists?[4,this.queryUpdate(e)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,this.queryInsert(e)];case 3:i=r.sent(),r.label=4;case 4:return this.syncAttrAndOrig(),[2,i];case 5:throw n=r.sent(),new Error(n.message);case 6:return[2]}})})},i.prototype.delete=function(){return e(this,void 0,Promise,function(){var t,e,i;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=this.createBuilder(),this.exists?[4,this.queryDelete(t)]:[3,2];case 1:return e=r.sent(),this.exists=!1,[2,e];case 2:return[2,!1];case 3:throw i=r.sent(),new Error(i.message);case 4:return[2]}})})},i.createModel=function(){return new this},i.createBuilderStatic=function(){return this.createModel().createBuilder()},i.destroy=function(t){return e(this,void 0,Promise,function(){var e,i,n,s;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.createModel(),i=e.createBuilder(),n=e.getPrimaryKey(),[4,i.whereIn(n,t).delete()];case 1:return[2,r.sent()];case 2:throw s=r.sent(),new Error(s.message);case 3:return[2]}})})},i.find=function(t,e,r){return void 0===e&&(e=["*"]),this.createBuilderStatic().find(t,e,r)},i.findOrNew=function(t,i){return void 0===i&&(i=["*"]),e(this,void 0,Promise,function(){var e,n;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.find(t,i)];case 1:return(e=r.sent())?[2,e]:[2,new this];case 2:throw n=r.sent(),new Error(n.message);case 3:return[2]}})})},i.prototype.__iterator=function(){return this.toJSON()},i.prototype.__get=function(t){return"symbol"==typeof t?this.toJSON():this.getAttribute(t)},i.prototype.__set=function(t,e){this.setAttribute(t,e)},i.prototype.__isset=function(t){return t in this.attributes},i.prototype.__unset=function(t){delete this.attributes[t]},i.__callStatic=function(t){var e=this.createBuilderStatic();return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e[t].apply(e,r)}},i.prototype.toString=function(){return JSON.stringify(this.toJSON(),null,2)},i.prototype.toJSON=function(){var e=t({},this.attributes),r=this.relatives;for(var i in r)e[i]=r[i]?r[i].toJSON():{};return e},i}();exports.default=h;
},{"./Collection":"cXx1","./Query":"UJnB","./Builder":"G2GE","./Relationships/HasOne":"cNxe","./Relationships/HasMany":"bkXW","./Relationships/BelongsTo":"IAWZ"}],"oug4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Model=void 0;var e=function(e,t){return function(o){o.entity=e,o.table=t}};exports.Model=e;
},{}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelEntity=exports.Model=exports.Eloquent=void 0;var t=require("./Eloquent");Object.defineProperty(exports,"Eloquent",{enumerable:!0,get:function(){return e(t).default}});var r=require("./Model");Object.defineProperty(exports,"Model",{enumerable:!0,get:function(){return e(r).default}});var o=require("./Decorators/Model");Object.defineProperty(exports,"ModelEntity",{enumerable:!0,get:function(){return o.Model}});
},{"./Eloquent":"R6uy","./Model":"NviM","./Decorators/Model":"oug4"}]},{},["QCba"], null)
//# sourceMappingURL=/index.js.map